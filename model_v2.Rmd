---
title: "model_v2"
author: "Stuti Munshi"
date: "07/07/2024"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Packages
```{r cars}
library(dplyr)   
library(readr)  
library(ggplot2)
#library(statsr)
library(gridExtra)
library(corrplot)
library(tidyr)
```

## Dataset 
```{r dataset}
movieset <- read.csv("output.csv")
print(movieset)
```


## Binning

```{r}
custom_breaks <- c(0, 10000000, 30000000, 90000000, 150000000, Inf)
bin_labels <- c("Very Low", "Low", "Medium", "High", "Very High")

movieset$gross_equal_width_bins <- cut(movieset$gross, breaks = custom_breaks, labels = bin_labels, include.lowest = TRUE, right = FALSE)

bin_freq <- table(movieset$gross_equal_width_bins)

barplot(bin_freq, 
     main = "Frequency of Gross Revenue Bins",
     xlab = "Bins",
     ylab = "Frequency")

```

# Numerical and Categorical Variables

```{r numerical plots}

p1 <- ggplot(aes(x=year), data=movieset) + 
  geom_histogram(aes(y=100*(..count..)/sum(..count..)), color='black', fill='white') + ylab('percentage') + ggtitle('year')
p2 <- ggplot(aes(x=score), data=movieset) +
  geom_histogram(aes(y=100*(..count..)/sum(..count..)), color='black', fill='white') + ylab('percentage') + ggtitle('score')
p3 <- ggplot(aes(x=log10(votes)), data=movieset) +
  geom_histogram(aes(y=100*(..count..)/sum(..count..)), color='black', fill='white') + ylab('percentage') + ggtitle('votes')
p4 <- ggplot(aes(x=log10(budget)), data=movieset) +
  geom_histogram(aes(y=100*(..count..)/sum(..count..)), color='black', fill='white') + ylab('percentage') + ggtitle('budget')
p5 <- ggplot(aes(x=runtime), data=movieset) +
  geom_histogram(aes(y=100*(..count..)/sum(..count..)), color='black', fill='white') + ylab('percentage') + ggtitle('runtime')
grid.arrange(p1, p2, p3, p4, p5, ncol=2)

```
For the analysis, we will be using year, score, log(votes), log(budget) and runtime. They all have reasonably broad distributions which make them appropriate candidtates.

```{r numerical correlation matrix}
hist(movieset$gross, breaks = 30)
summary(movieset$gross)

numeric_columns <- names(movieset)[sapply(movieset, is.numeric)]
numeric_columns <- setdiff(numeric_columns, "gross")
numeric_vars <- movieset[, numeric_columns]
print(names(numeric_vars))

correlation_matrix <- cor(numeric_vars)
print(correlation_matrix)
```
As the correlation between all of the numerical variables are relatively low, they can all be used for the prediction analysis. 

```{r categorical plots}

#Plotting genre to gross frequency
p1 <- ggplot(aes(x = genre), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Genres') +
  coord_flip()


grid.arrange(p1, ncol = 2)

# Create boxplot
boxplot(movieset$gross_equal_width_bins ~ genre, data = movieset,
        main = 'Gross Revenue vs. Genre', 
        xlab = 'Genre', 
        ylab = 'Gross Revenue',
        las = 2,   # Rotate x-axis labels to be vertical
        cex.axis = 0.8, # Reduce the font size of axis labels
        par(mar = c(10, 5, 4, 2) + 0.1)) # Increase the bottom margin


#Plotting rating to gross frequency
p2 <- ggplot(aes(x = rating), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Rating') +
  coord_flip()


grid.arrange(p2, ncol = 2)

# Create boxplot
boxplot(movieset$gross_equal_width_bins ~ rating, data = movieset,
        main = 'Gross Revenue vs. Rating', 
        xlab = 'Rating', 
        ylab = 'Gross Revenue',
        las = 2,   # Rotate x-axis labels to be vertical
        cex.axis = 0.8, # Reduce the font size of axis labels
        par(mar = c(10, 5, 4, 2) + 0.1)) # Increase the bottom margin


#Plotting country to gross frequency
p3 <- ggplot(aes(x = country), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Country') +
  coord_flip()


grid.arrange(p3, ncol = 2)

# Create boxplot
boxplot(movieset$gross_equal_width_bins ~ country, data = movieset,
        main = 'Gross Revenue vs. Country', 
        xlab = 'Country', 
        ylab = 'Gross Revenue',
        las = 2,   # Rotate x-axis labels to be vertical
        cex.axis = 0.8, # Reduce the font size of axis labels
        par(mar = c(10, 5, 4, 2) + 0.1)) # Increase the bottom margin


#Plotting company to gross frequency
p4 <- ggplot(aes(x = company), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Company') +
  coord_flip()

grid.arrange(p4, ncol = 2)

#Plotting director to gross frequency
p5 <- ggplot(aes(x = director), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Director') +
  coord_flip()

grid.arrange(p5, ncol = 2)

#Plotting writer to gross frequency
p6 <- ggplot(aes(x = writer), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Writer') +
  coord_flip()

grid.arrange(p6, ncol = 2)

#Plotting star to gross frequency
p7 <- ggplot(aes(x = star), data = movieset) +
  geom_bar(aes(y = 100 * (..count..) / sum(..count..)), fill = "skyblue", color = "black") +
  ylab('Percentage') +
  ggtitle('Star') +
  coord_flip()

grid.arrange(p7, ncol = 2)


```
<<<<<<< HEAD
We will be using genre, rating, and country as prediction variables because gross revenue has a correlation with those three. Due to the high number of unique entries of company, director, writer, and star, we have decided to exclude these variables from our predictive model.
=======
## Splitting dataset into train and test
```{r}
set.seed(2017)
split <- sample(seq_len(nrow(movieset)), size = floor(0.7 * nrow(movieset)))
train <- movieset[split, ]
test <- movieset[-split, ]
dim(train)
dim(test)
```
>>>>>>> aa361e3acd3c7e8500e8ad802b4dd6d3ad488045
